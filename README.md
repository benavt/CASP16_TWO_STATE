# CASP Data Processing

This repository contains scripts and utilities for processing, analyzing, and visualizing data for the CASP (Critical Assessment of Structure Prediction) assessment. The workflow includes gathering data, processing scores, identifying missing data points, and generating plots and summary files.

## Directory Structure

```
CASP_DATA_PROCESSING/
├── DATA/      # Contains gathered data files (input for processing)
├── OUTPUT/    # Output CSVs and summary files generated by scripts
├── PLOTS/     # Generated plots and visualizations
├── gather_data.py
├── process_two_state_score.py
```

## Prerequisites

- Python 3.7+
- Required Python packages:
  - pandas
  - matplotlib
  - adjustText
  - tqdm

Install dependencies with:
```bash
pip install pandas matplotlib adjustText tqdm
```

## Script Overview

### 1. `gather_data.py`
Copies output files from the CASP assessment targets into the local `DATA/` directory.

- **Usage:**
  ```bash
  python gather_data.py
  ```
- **Note:**
  - Expects the source data in `../Casp_assessment/Targets/<TARGET>/Output/` relative to the script location.
  - TARGETS are hardcoded in the script.

### 2. `process_two_state_score.py`
Processes the gathered data to compute two-state scores for each target and score type, generates summary CSVs in `OUTPUT/`, and creates scatter and bar plots in `PLOTS/`.

- **Usage:**
  ```bash
  python process_two_state_score.py
  ```
- **Note:**
  - The script automatically processes all targets and score types defined in `TARGET_SCORE_DICT`.
  - Input files are expected in `DATA/`.
  - Output CSVs and plots are saved in `OUTPUT/` and `PLOTS/` respectively.

## Output CSV Columns

Each output CSV file in the `OUTPUT/` directory contains the following columns:

- **Group**: The submission group identifier (e.g., TS314).
- **Combined_Score**: The sum of the two best scores for the group, depending on which combination produced the Best_Score.
- **Best_v1_ref**: The best score for this group using a v1 reference (from the best combination).
- **Best_v2_ref**: The best score for this group using a v2 reference (from the best combination).
- **V1_Model_For_Combined_Score**: The group and model version/number string (e.g., TS314_v1_4) for the model that produced Best_v1_ref.
- **V2_Model_For_Combined_Score**: The group and model version/number string (e.g., TS314_v2_5) for the model that produced Best_v2_ref.
- **Best_Score**: The highest score among all model/version combinations for this group.
- **Best_Source**: The model/version combination (v1_v1, v1_v2, v2_v1, v2_v2) that produced the Best_Score.
- **v1_v1_Score**: Best score for this group using v1 model against v1 reference.
- **v1_v2_Score**: Best score for this group using v2 model against v1 reference.
- **v2_v1_Score**: Best score for this group using v1 model against v2 reference.
- **v2_v2_Score**: Best score for this group using v2 model against v2 reference.
- **v1_v1_ModelNumber**: Model number of the model that produced the v1_v1_Score.
- **v1_v2_ModelNumber**: Model number of the model that produced the v1_v2_Score.
- **v2_v1_ModelNumber**: Model number of the model that produced the v2_v1_Score.
- **v2_v2_ModelNumber**: Model number of the model that produced the v2_v2_Score.

## Workflow

1. **Gather Data:**
   - Run `gather_data.py` to collect all necessary data files into `DATA/`.
2. **Process Scores:**
   - Run `process_two_state_score.py` to generate summary CSVs and plots.

## License

This project is intended for research and assessment purposes. Please contact the repository owner for licensing details.
